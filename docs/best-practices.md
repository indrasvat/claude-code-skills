# Best Practices

Repository-specific conventions and patterns for managing Claude Code skills.

## Repository Organization

### Flat Structure

Keep all skills in a flat `skills/` directory:

```
skills/
├── iterm2-driver/
├── pdf-processor/
└── api-client-gen/
```

**Why**: Simple, scalable, easy to navigate. No artificial categorization needed.

### Naming Conventions

**Skills**:
- Format: lowercase-with-hyphens
- Use gerund form: `processing-pdfs`, `analyzing-logs`
- Be specific: `iterm2-driver` not `terminal-helper`

**Example Scripts**:
- Numbered: `01-basic.py`, `02-intermediate.py`
- Descriptive: `01-basic-tab.py`, `02-dev-layout.py`
- Corresponds to SKILL.md examples

**Automation Scripts** (generated by Claude):
- Action-oriented: `watch_build_logs.py`, `drive_k9s_debug.py`
- Avoid generic: `test.py`, `script.py`

## Skill Development

### File Size Guidelines

- **SKILL.md**: Keep under 500 lines for optimal performance
- **Total skill size**: Keep reasonable (<1MB)
- **Examples**: Full, runnable code (not pseudocode)

### Progressive Disclosure

Structure skills from simple to complex:

```markdown
# Skill Name

## Core Concepts
Basic understanding

## Basic Examples
Simple, common cases

## Advanced Examples
Complex, sophisticated patterns

## Reference
Link to detailed specs
```

### Documentation Style

**Be concise**: Claude is smart, don't over-explain

❌ "Functions are reusable blocks of code that..."
✅ "Use this function to parse API responses:"

**Be concrete**: Show real examples, not abstract patterns

❌ "You can iterate over collections..."
✅ `for item in items: process(item)`

**Be specific**: Include exact commands, paths, and values

❌ "Install the dependencies"
✅ `uv add requests rich`

## Script Management

### Inline Dependencies

Always use uv metadata for Python scripts:

```python
# /// script
# requires-python = ">=3.13"
# dependencies = [
#   "requests",
#   "rich",
# ]
# ///
```

### Execution Guidelines

Include clear execution instructions:

```markdown
## Running Scripts

All scripts use uv:

\`\`\`bash
uv run script_name.py
\`\`\`

Never use `python script_name.py` directly.
```

### Storage Locations

Guide Claude on where to store generated scripts:

- **Project-specific**: `./.claude/automations/`
- **General utilities**: `~/.claude/automations/`

## Version Control

### Commit Messages

Follow conventional commits:

```
feat: add pdf-processor skill
fix: correct iterm2 screen parsing logic
docs: update installation instructions
chore: update dependencies
```

### What to Commit

✅ Commit:
- SKILL.md files
- Example scripts
- Documentation
- CLI tools
- Configuration files

❌ Don't commit:
- Backup directories
- Generated artifacts
- User-specific paths
- Temporary files

### Gitignore

```gitignore
# Backups
.claude-backup/
*-backup-*/

# OS
.DS_Store
Thumbs.db

# IDE
.vscode/
.idea/
*.swp

# Python
__pycache__/
*.pyc
.venv/
```

## Testing

### Before Committing

1. **Validate YAML**: Ensure frontmatter is correct
2. **Run examples**: All example scripts should execute
3. **Test in Claude Code**: Verify skill triggers correctly
4. **Check exit codes**: Ensure CLI tools exit cleanly

### Test Queries

Create test queries for each skill:

**iterm2-driver**:
- "Create a 4-pane development layout in iTerm2"
- "Drive the Python REPL to test a function"
- "Automate nano to create a file"

### Edge Cases

Test common edge cases:
- No active window
- Skill already installed
- Conflicting installations
- Missing dependencies

## Installation Management

### Use the CLI Tool

Always use `cc-skills` for management:

```bash
# Install
cc-skills install

# Update
cc-skills update

# Check status
cc-skills status
```

### Backup Strategy

The CLI automatically backs up before destructive operations:

```bash
# Manual backup
cc-skills backup

# Automatic backups during:
- install (if existing directory found)
- uninstall
- restore
```

### Multi-Machine Sync

Keep skills in sync across machines:

**Via Bootstrap (Recommended)**:
```bash
# All machines: One-command install
bash <(curl -fsSL https://raw.githubusercontent.com/indrasvat/claude-code-skills/main/bootstrap.sh)

# Then update anytime with:
cc-skills update
```

**Manual Sync**:
```bash
# Machine 1: Make changes
cd ~/.config/claude-code-skills
git add skills/new-skill
git commit -m "feat: add new-skill"
git push

# Machine 2: Update
cd ~/.config/claude-code-skills
git pull
cc-skills install
```

## Documentation

### README Structure

- Overview
- Quick start
- Installation
- Usage examples
- Troubleshooting
- Contributing

### Keep Docs Updated

When adding skills:
- [ ] Update README skills list
- [ ] Add usage examples
- [ ] Update troubleshooting if needed
- [ ] Tag release if significant

## Error Handling

### In Skills

Always handle common errors:

```python
if window is None:
    print("No active window found")
    return

if not session:
    print("Failed to create session")
    return
```

### In CLI Tools

Provide helpful error messages:

```bash
if [ ! -d "${SKILLS_DIR}" ]; then
    log_error "Skills directory not found: ${SKILLS_DIR}"
    log_info "Create it with: mkdir -p ${SKILLS_DIR}"
    exit 1
fi
```

## Performance

### Keep Skills Focused

One skill = one domain:

✅ `iterm2-driver`: Terminal automation
✅ `pdf-processor`: PDF manipulation
❌ `general-utilities`: Too broad

### Lazy Loading

Claude loads skills on-demand. Optimize for:
- Small frontmatter (quick filtering)
- Focused description (accurate matching)
- Efficient content (quick parsing)

### Caching

Claude caches skill content. Changes take effect:
- Immediately for new Claude Code instances
- After restart for running instances

## Security

### Never Commit Secrets

Don't commit:
- API keys
- Passwords
- Private keys
- User-specific paths with PII

### Script Safety

In automation scripts:
- Validate inputs
- Escape shell arguments: `shlex.quote()`
- Use absolute paths when critical
- Handle signals (Ctrl+C) gracefully

### Permissions

CLI tools should:
- Request confirmation for destructive actions
- Create backups before modifications
- Validate targets before operations
- Exit safely on errors

## Continuous Improvement

### Iterate on Real Usage

- Start simple
- Add examples as needed
- Refine based on actual questions
- Split when approaching 500 lines

### Gather Feedback

Track:
- Which examples are used most
- Common error patterns
- Missing functionality
- Confusing instructions

### Version Releases

Tag releases for significant updates:

```bash
git tag -a v1.0.0 -m "Initial release with iterm2-driver"
git push origin v1.0.0
```

## Community

### Forking

Encourage others to fork and customize:
- Clear LICENSE (MIT recommended)
- Contributing guidelines
- Issue templates
- Code of conduct

### Sharing

Share patterns that work:
- Blog posts
- Example repos
- Claude Code community
- Pull requests to official skills

## Maintenance

### Regular Updates

- Update dependencies
- Refresh examples for new Claude Code features
- Fix bugs reported by users
- Improve clarity based on usage

### Deprecation

If deprecating a skill:
1. Mark as deprecated in frontmatter
2. Add deprecation notice in SKILL.md
3. Provide migration path
4. Remove after grace period

## Quick Checklist

Before committing a new skill:

- [ ] YAML frontmatter valid
- [ ] Description includes WHAT and WHEN
- [ ] SKILL.md under 500 lines
- [ ] All examples runnable
- [ ] Scripts have uv metadata
- [ ] Tested in Claude Code
- [ ] README updated
- [ ] CLI tests pass
- [ ] No secrets committed
- [ ] Meaningful commit message

---

For more guidance:
- [Skill Authoring](skill-authoring.md)
- [Troubleshooting](troubleshooting.md)
- [Official Anthropic Docs](https://docs.anthropic.com/en/docs/build-with-claude/agent-skills)
